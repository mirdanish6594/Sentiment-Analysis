<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sentiment Analysis Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tailwindcss/2.2.19/tailwind.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" />
    <style>
        .gradient-bg {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }
        .card {
            transition: transform 0.2s ease-in-out;
        }
        .card:hover {
            transform: translateY(-5px);
        }
        .loading {
            display: none;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Navigation -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <i class="fas fa-brain text-purple-600 text-2xl"></i>
                    <span class="ml-2 text-xl font-bold text-gray-800">SentimentAI</span>
                </div>
                <div class="flex items-center space-x-4">
                    <a href="#features" class="text-gray-600 hover:text-gray-900">Features</a>
                    <a href="#demo" class="text-gray-600 hover:text-gray-900">Try Demo</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="gradient-bg">
        <div class="max-w-7xl mx-auto py-20 px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h1 class="text-4xl tracking-tight font-extrabold text-white sm:text-5xl md:text-6xl">
                    Understand Your Customer's Voice
                </h1>
                <p class="mt-3 max-w-md mx-auto text-base text-gray-100 sm:text-lg md:mt-5 md:text-xl md:max-w-3xl">
                    Transform customer feedback into actionable insights with our advanced sentiment analysis tool.
                </p>
                <div class="mt-5 max-w-md mx-auto sm:flex sm:justify-center md:mt-8">
                    <div class="rounded-md shadow">
                        <a href="#demo" class="w-full flex items-center justify-center px-8 py-3 border border-transparent text-base font-medium rounded-md text-purple-700 bg-white hover:bg-gray-50 md:py-4 md:text-lg md:px-10">
                            Try it Now
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Features Section -->
    <div id="features" class="py-12 bg-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <h2 class="text-3xl font-extrabold text-gray-900">Powerful Features</h2>
            </div>
            <div class="mt-10">
                <div class="grid grid-cols-1 gap-10 sm:grid-cols-2 lg:grid-cols-3">
                    <div class="card bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="text-center">
                                <i class="fas fa-chart-pie text-4xl text-purple-600"></i>
                                <h3 class="mt-2 text-lg font-medium text-gray-900">Bulk Analysis</h3>
                                <p class="mt-1 text-sm text-gray-500">Analyze thousands of reviews instantly with our CSV upload feature</p>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="text-center">
                                <i class="fas fa-bolt text-4xl text-purple-600"></i>
                                <h3 class="mt-2 text-lg font-medium text-gray-900">Real-time Processing</h3>
                                <p class="mt-1 text-sm text-gray-500">Get instant sentiment predictions for your text input</p>
                            </div>
                        </div>
                    </div>
                    <div class="card bg-white overflow-hidden shadow rounded-lg">
                        <div class="px-4 py-5 sm:p-6">
                            <div class="text-center">
                                <i class="fas fa-chart-bar text-4xl text-purple-600"></i>
                                <h3 class="mt-2 text-lg font-medium text-gray-900">Visual Analytics</h3>
                                <p class="mt-1 text-sm text-gray-500">Beautiful visualizations of sentiment distribution</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Demo Section -->
    <div id="demo" class="py-12 bg-gray-50">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-extrabold text-gray-900">Try It Yourself</h2>
                <p class="mt-2 text-gray-600">Upload a CSV file or enter text to analyze sentiment</p>
            </div>
            <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
                <!-- File Upload Section -->
                <div class="bg-white shadow rounded-lg p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Bulk Analysis</h3>
                    <div class="space-y-4">
                        <div class="flex items-center justify-center w-full">
                            <label class="w-full flex flex-col items-center px-4 py-6 bg-white rounded-lg shadow-lg tracking-wide border border-purple-500 cursor-pointer hover:bg-purple-50">
                                <i class="fas fa-cloud-upload-alt text-purple-600 text-3xl"></i>
                                <span class="mt-2 text-base">Upload CSV file</span>
                                <input type="file" id="csvFileInput" accept=".csv" class="hidden" />
                            </label>
                        </div>
                        <div id="fileName" class="text-sm text-gray-500 text-center"></div>
                    </div>
                </div>

                <!-- Text Input Section -->
                <div class="bg-white shadow rounded-lg p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Single Text Analysis</h3>
                    <div class="space-y-4">
                        <textarea id="textInput" rows="4" class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-purple-500 focus:border-purple-500" placeholder="Enter your text here..."></textarea>
                    </div>
                </div>
            </div>

            <!-- Prediction Button -->
            <div class="mt-6 text-center">
                <button onclick="predict()" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-purple-600 hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500">
                    <span>Analyze Sentiment</span>
                    <i class="fas fa-spinner loading ml-2"></i>
                </button>
            </div>

            <!-- Results Section -->
            <div class="mt-8 grid grid-cols-1 gap-6 lg:grid-cols-2">
                <div class="bg-white shadow rounded-lg p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Prediction Result</h3>
                    <div id="predictionResult" class="text-center text-gray-600">
                        Results will appear here
                    </div>
                </div>
                <div class="bg-white shadow rounded-lg p-6">
                    <h3 class="text-lg font-medium text-gray-900 mb-4">Visualization</h3>
                    <div id="graphContainer" class="flex justify-center">
                        <img src="/api/placeholder/400/300" alt="Sentiment distribution graph will appear here" class="max-w-full h-auto" />
                    </div>
                </div>
            </div>

            <!-- Download Button -->
            <div class="mt-6 text-center">
                <button id="downloadBtn" style="display:none" onclick="downloadPredictions()" class="inline-flex items-center px-6 py-3 border border-transparent text-base font-medium rounded-md text-white bg-green-600 hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">
                    <i class="fas fa-download mr-2"></i>
                    <span>Download Results</span>
                </button>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-gray-800">
        <div class="max-w-7xl mx-auto py-12 px-4 sm:px-6 lg:px-8">
            <div class="text-center">
                <p class="text-base text-gray-400">&copy; 2025 SentimentAI. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // File input handling
        document.getElementById('csvFileInput').addEventListener('change', function(e) {
            const fileName = e.target.files[0]?.name;
            document.getElementById('fileName').textContent = fileName || 'No file selected';
        });

        function predict() {
            const loadingIcon = document.querySelector('.loading');
            const csvFileInput = document.getElementById("csvFileInput");
            const textInput = document.getElementById("textInput");
            const predictionResult = document.getElementById("predictionResult");
            const graphContainer = document.getElementById("graphContainer");

            // Show loading state
            loadingIcon.style.display = 'inline-block';
            predictionResult.innerHTML = 'Processing...';

            if (csvFileInput.files.length > 0) {
                // CSV file prediction
                const formData = new FormData();
                formData.append("file", csvFileInput.files[0]);

                fetch("http://localhost:5000/predict", {
                    method: "POST",
                    body: formData
                })
                .then(response => {
                    if (response.headers.get('X-Graph-Exists') === 'true') {
                        const graphData = response.headers.get('X-Graph-Data');
                        displayGraph(graphData);
                    }
                    return response.blob();
                })
                .then(blob => {
                    document.getElementById("downloadBtn").style.display = "block";
                    predictionResult.innerHTML = 'Analysis complete! Click the download button below to get your results.';
                    
                    document.getElementById("downloadBtn").onclick = function() {
                        const url = URL.createObjectURL(blob);
                        const a = document.createElement("a");
                        a.href = url;
                        a.download = "Predictions.csv";
                        document.body.appendChild(a);
                        a.click();
                        document.body.removeChild(a);
                    };
                })
                .catch(error => {
                    predictionResult.innerHTML = 'Error: ' + error.message;
                })
                .finally(() => {
                    loadingIcon.style.display = 'none';
                });

            } else if (textInput.value.trim() !== "") {
                // Single text prediction
                fetch("http://localhost:5000/predict", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify({ "text": textInput.value.trim() })
                })
                .then(response => response.json())
                .then(data => {
                    const sentiment = data.prediction;
                    const color = sentiment === 'Positive' ? 'text-green-600' : 'text-red-600';
                    predictionResult.innerHTML = `
                        <div class="text-2xl ${color} font-bold">
                            ${sentiment}
                            <i class="fas fa-${sentiment === 'Positive' ? 'smile' : 'frown'} ml-2"></i>
                        </div>
                    `;
                })
                .catch(error => {
                    predictionResult.innerHTML = 'Error: ' + error.message;
                })
                .finally(() => {
                    loadingIcon.style.display = 'none';
                });
            }
        }

        function displayGraph(graphData) {
            const graphContainer = document.getElementById("graphContainer");
            graphContainer.innerHTML = '';
            const img = document.createElement('img');
            img.src = "data:image/png;base64," + graphData;
            img.className = 'max-w-full h-auto';
            graphContainer.appendChild(img);
        }
    </script>
</body>
</html>